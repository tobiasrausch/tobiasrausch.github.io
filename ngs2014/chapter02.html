<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DNA Variant Calling &mdash; ngs2014 Oct 2014 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'Oct 2014',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ngs2014 Oct 2014 documentation" href="index.html" />
    <link rel="next" title="Structural Variant Analysis using Simulated Data" href="chapter03.html" />
    <link rel="prev" title="Alignment &amp; Data Quality Control" href="chapter01.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="chapter03.html" title="Structural Variant Analysis using Simulated Data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="chapter01.html" title="Alignment &amp; Data Quality Control"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ngs2014 Oct 2014 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="dna-variant-calling">
<h1>DNA Variant Calling<a class="headerlink" href="#dna-variant-calling" title="Permalink to this headline">¶</a></h1>
<div class="section" id="alignment-pre-processing">
<h2>Alignment Pre-processing<a class="headerlink" href="#alignment-pre-processing" title="Permalink to this headline">¶</a></h2>
<p>Many DNA variant callers suggest different alignment pre-processing steps before the actual computation of single-nucleotide variants (SNVs), short insertions and deletions (InDels) and large structural variants (SVs). Typical pre-processing steps are duplicate removal, local InDel realignment and the trimming of low quality bases <a class="reference internal" href="citations.html#gatk" id="id1">[GATK]</a> <a class="reference internal" href="citations.html#fastx" id="id2">[FASTX]</a> <a class="reference internal" href="citations.html#trimmomatic" id="id3">[Trimmomatic]</a> <a class="reference internal" href="citations.html#picard" id="id4">[Picard]</a>. Some of these steps can be carried out before or after the initial alignment. For most variant callers a fundamental pre-requisite is the removal of duplicate reads:</p>
<div class="highlight-bash"><div class="highlight"><pre>java -jar <span class="k">${</span><span class="nv">PI</span><span class="k">}</span>/MarkDuplicates.jar <span class="nv">I</span><span class="o">=</span>align.sort.bam <span class="nv">O</span><span class="o">=</span>align.rmdup.bam <span class="nv">M</span><span class="o">=</span>duplicates.txt <span class="nv">AS</span><span class="o">=</span><span class="nb">true</span>
samtools index align.rmdup.bam
less duplicates.txt
</pre></div>
</div>
<p>The picard online documentation explains the metrics produced by MarkDuplicates <a class="reference internal" href="citations.html#picarddoc" id="id5">[PicardDoc]</a>.
The histogram at the bottom of the file approximates the estimated increase in non-redundant sequencing coverage if we double, triple, etc. the raw sequencing data.
This histogram is especially useful to estimate whether it makes sense to sequence a given library deeper or not.</p>
</div>
<div class="section" id="single-nucleotide-variant-calling">
<h2>Single-Nucleotide Variant Calling<a class="headerlink" href="#single-nucleotide-variant-calling" title="Permalink to this headline">¶</a></h2>
<p>Samtools mpileup is one option to call SNVs in a sample. Please note that the down-sampling of the course data to speed-up the analyses obviously affects the sensitivity and specificity of SNV calling but still serves the purpose of illustrating the general workflow used for SNV calling. Mpileup just needs the reference and the bam file to call SNVs. The output is in vcf format (variant-call-format).</p>
<div class="highlight-bash"><div class="highlight"><pre>samtools mpileup -ugf chr7.fa align.rmdup.bam | bcftools view -cvg - &gt; snv.raw.vcf
</pre></div>
</div>
<p>The above command should run for about 10 minutes. Samtools mpileup also offers a simple perl script to filter SNVs for low coverage, low mapping quality, adjacent gaps and similar biases that are known to be related to an increased false positive rate of SNV calls. For this course, we will just filter SNVs with a coverage below 5.</p>
<div class="highlight-bash"><div class="highlight"><pre>perl ./bin/vcfutils.pl varFilter -d 5 snv.raw.vcf &gt; snv.vcf
</pre></div>
</div>
<p>A vcf file has multiple header lines starting with a hash # sign. Below the header line is one record for each SNV and InDel. The record format is described in the below table:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="10%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Col</strong></td>
<td><strong>Field</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td>1</td>
<td>CHROM</td>
<td>Chromosome name</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>POS</td>
<td>1-based position. For an indel, this is the position preceding the indel.</td>
</tr>
<tr class="row-even"><td>3</td>
<td>ID</td>
<td>Variant identifier. Usually the dbSNP rsID.</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>REF</td>
<td>Reference sequence at POS involved in the variant. For a SNP, it is a single base.</td>
</tr>
<tr class="row-even"><td>5</td>
<td>ALT</td>
<td>Comma delimited list of alternative sequence(s).</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>QUAL</td>
<td>Phred-scaled probability of all samples being homozygous reference.</td>
</tr>
<tr class="row-even"><td>7</td>
<td>FILTER</td>
<td>Semicolon delimited list of filters that the variant fails to pass.</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>INFO</td>
<td>Semicolon delimited list of variant information.</td>
</tr>
<tr class="row-even"><td>9</td>
<td>FORMAT</td>
<td>Colon delimited list of the format of individual genotypes in the following fields.</td>
</tr>
<tr class="row-odd"><td>10</td>
<td>+Sample(s)</td>
<td>Individual genotype information defined by FORMAT.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>You can look at the header of the vcf file using grep:</p>
<div class="highlight-bash"><div class="highlight"><pre>grep <span class="s2">&quot;^#&quot;</span> snv.vcf
</pre></div>
</div>
<p>If you want to include the first SNV record you can use:</p>
<div class="highlight-bash"><div class="highlight"><pre>grep <span class="s2">&quot;^#&quot;</span> -A 1 snv.vcf
</pre></div>
</div>
<p>The samtools package also has a simple alignment viewer called samtools tview. In that viewer, a dot or a comma in the read represents a match to the reference, either on the forward (dot) or reverse (comma) strand. Any other DNA nucleotide that appears in the read is a mismatch. Upper case letters are mismatches on the forward strand whereas lower case letters are mismatches on the reverse strand. Pick a few SNVs and InDels randomly and inspect them in the viewer by running the commands below. Once you are in the viewer press &#8216;g&#8217; and enter the coordinates of the SNV, e.g. &#8216;chr7:72857049&#8217;. To exit the viewer press &#8216;q&#8217;. Two variants that look reasonably <em>confident</em> from the alignment are below.</p>
<div class="highlight-bash"><div class="highlight"><pre>egrep <span class="s2">&quot;72857049|129091615&quot;</span> snv.vcf
samtools tview align.rmdup.bam chr7.fa
</pre></div>
</div>
<p>If you are working with multiple VCF files from different samples then merging VCFs, filtering and subsetting these files is a common task that can be accomplished using VCFtools <a class="reference internal" href="citations.html#vcftools" id="id6">[VCFtools]</a>.</p>
</div>
<div class="section" id="single-nucleotide-variant-annotation">
<h2>Single-Nucleotide Variant Annotation<a class="headerlink" href="#single-nucleotide-variant-annotation" title="Permalink to this headline">¶</a></h2>
<p>The raw SNV calls do contain false positives, which may be due to intrinsic properties of the sequencing data such as poor base qualities or due to segmental duplications, repeats or similar reference biases. Annotating the SNV calls with these reference features, such as segmental duplications, is one way to flag these SNVs as less confident. In addition, we also need an adequate SNV annotation that allows us to quickly identify <em>interesting</em> mutations such as coding missense and nonsense mutations. Different tools are available for this kind of SNV annotation such as SnpEff <a class="reference internal" href="citations.html#snpeff" id="id7">[SnpEff]</a> and Annovar <a class="reference internal" href="citations.html#annovar" id="id8">[Annovar]</a>. We will use Annovar in the following and the scripts required for annovar are in the <em>bin</em> directory of the course data. First we convert the SNVs to the input format of Annovar:</p>
<div class="highlight-bash"><div class="highlight"><pre>./bin/convert2annovar.pl --format vcf4 snv.vcf &gt; snv.av
</pre></div>
</div>
<p>The annovar format is very similar to vcf. The columns are chr, start, end, reference allele, alternative allele, zygosity, quality and depth. Annovar relies on the annotation databases of the UCSC genome browser and thus, these databases need to be downloaded once. The download commands are below. To save time the databases have already been downloaded prior to the course so you can skip this step.</p>
<div class="highlight-bash"><div class="highlight"><pre>mkdir hg19db
./bin/annotate_variation.pl --webfrom annovar --buildver hg19 --downdb refGene hg19db/
</pre></div>
</div>
<p>Using these mRNA sequences the SNVs are now categorized into synonymous and non-synonymous SNVs:</p>
<div class="highlight-bash"><div class="highlight"><pre>./bin/annotate_variation.pl --buildver hg19 --outfile snv --hgvs snv.av hg19db/
</pre></div>
</div>
<p>Annovar creates two output files <em>snv.variant_function</em> and <em>snv.exonic_variant_function</em>. The variant function file contains all variants prefixed by their location in the genome (intergenic, exonic, intronic, etc.).</p>
<div class="highlight-bash"><div class="highlight"><pre>cut -f 1 snv.variant_function  | sort | uniq -c
</pre></div>
</div>
<p>The exonic variant function file further classifies the exonic SNVs into the type of coding change (synonymous, non-synonymous, frameshift, etc.) they cause.</p>
<div class="highlight-bash"><div class="highlight"><pre>cut -f 2 snv.exonic_variant_function | sort | uniq -c
</pre></div>
</div>
<p>In order to further filter the SNVs one would like to distinguish most likely polymorphic SNPs from real mutations. The 1000 Genomes data <a class="reference internal" href="citations.html#gp" id="id9">[GP]</a> and/or dbSNP <a class="reference internal" href="citations.html#dbsnp" id="id10">[dbSNP]</a> can be used for this. Again, we have pre-downloaded the necessary dbSNP database with the below command that you can skip:</p>
<div class="highlight-bash"><div class="highlight"><pre>./bin/annotate_variation.pl --webfrom ucsc --buildver hg19 --downdb snp137 hg19db/
</pre></div>
</div>
<p>Then the initial SNVs can be filtered against dbSNP using the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre>./bin/annotate_variation.pl --buildver hg19 --filter --dbtype snp137 snv.av hg19db/
</pre></div>
</div>
<p>This filtering creates two files, one with all the SNVs present in dbSNP, called <em>snv.av.hg19_snp137_dropped</em>, and one file with the remaining SNVs, called <em>snv.av.hg19_snp137_filtered</em>.</p>
<div class="highlight-bash"><div class="highlight"><pre>head snv.av.hg19_snp137_*
wc -l snv.av.hg19_snp137_*
</pre></div>
</div>
</div>
<div class="section" id="filtering-candidate-mutations">
<h2>Filtering candidate mutations<a class="headerlink" href="#filtering-candidate-mutations" title="Permalink to this headline">¶</a></h2>
<p>As a first initial candidate mutation set one could now use all the SNVs that are not present in dbSNP and then search for the ones that are non-synonymous, stopgain or stoploss.</p>
<div class="highlight-bash"><div class="highlight"><pre>grep -Ff snv.av.hg19_snp137_filtered snv.exonic_variant_function &gt; candidateSNVs.tsv
egrep <span class="s2">&quot;nonsynonymous|stopgain|stoploss&quot;</span> candidateSNVs.tsv
</pre></div>
</div>
<p>Since dbSNP does contain some SNVs that are known to be involved in diseases one could alternatively also use the 1000 Genomes data and exlcude all SNVs with an alternative allele frequency &gt;1% in the 1000 Genomes population. Assuming this is an autosomal recessive disorder one could now select candidate genes with at least 2 filtered SNVs. For a consanguineous autosomal recessive disorder one could further filter for homozygous SNVs using:</p>
<div class="highlight-bash"><div class="highlight"><pre>egrep <span class="s2">&quot;nonsynonymous|stopgain|stoploss&quot;</span> candidateSNVs.tsv | grep <span class="s2">&quot;hom&quot;</span>
</pre></div>
</div>
<p>To verify that the stopgain CARD11 mutation follows indeed a consanguineous autosomal recessive disorder one should sequence the SNV in the parents using Sanger sequencing.
The PCR traces are shown below.</p>
<img alt="_images/sanger.png" src="_images/sanger.png" />
<p>This concludes the single-nucleotide variant calling practical. I hope you enjoyed it!</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">DNA Variant Calling</a><ul>
<li><a class="reference internal" href="#alignment-pre-processing">Alignment Pre-processing</a></li>
<li><a class="reference internal" href="#single-nucleotide-variant-calling">Single-Nucleotide Variant Calling</a></li>
<li><a class="reference internal" href="#single-nucleotide-variant-annotation">Single-Nucleotide Variant Annotation</a></li>
<li><a class="reference internal" href="#filtering-candidate-mutations">Filtering candidate mutations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="chapter01.html"
                        title="previous chapter">Alignment &amp; Data Quality Control</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="chapter03.html"
                        title="next chapter">Structural Variant Analysis using Simulated Data</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/chapter02.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="chapter03.html" title="Structural Variant Analysis using Simulated Data"
             >next</a> |</li>
        <li class="right" >
          <a href="chapter01.html" title="Alignment &amp; Data Quality Control"
             >previous</a> |</li>
        <li><a href="index.html">ngs2014 Oct 2014 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, T. Rausch.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>
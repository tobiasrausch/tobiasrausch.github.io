<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SNV Calling | Variant calling for NGS data</title>
    <meta name="description" content="A tutorial on variant calling for NGS data using FreeBayes and Delly">
    
    
    <link rel="preload" href="/courses/vc/assets/css/0.styles.a71e43cb.css" as="style"><link rel="preload" href="/courses/vc/assets/js/app.12ae6cf7.js" as="script"><link rel="preload" href="/courses/vc/assets/js/2.65bda2c6.js" as="script"><link rel="preload" href="/courses/vc/assets/js/8.ff6ee130.js" as="script"><link rel="prefetch" href="/courses/vc/assets/js/10.1a851d49.js"><link rel="prefetch" href="/courses/vc/assets/js/3.216ec158.js"><link rel="prefetch" href="/courses/vc/assets/js/4.732b70ac.js"><link rel="prefetch" href="/courses/vc/assets/js/5.43c4220f.js"><link rel="prefetch" href="/courses/vc/assets/js/6.20585c88.js"><link rel="prefetch" href="/courses/vc/assets/js/7.2e70c853.js"><link rel="prefetch" href="/courses/vc/assets/js/9.5e3e46c5.js">
    <link rel="stylesheet" href="/courses/vc/assets/css/0.styles.a71e43cb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/courses/vc/" class="home-link router-link-active"><!----> <span class="site-name">Variant calling for NGS data</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/courses/vc/" class="nav-link">Home</a></div><div class="nav-item"><a href="/courses/vc/snv/" class="nav-link router-link-exact-active router-link-active">SNV Calling</a></div><div class="nav-item"><a href="/courses/vc/sv/" class="nav-link">SV Calling</a></div><div class="nav-item"><a href="/courses/vc/appendix/" class="nav-link">Appendix</a></div> <a href="https://github.com/tobiasrausch/variant-calling" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/courses/vc/" class="nav-link">Home</a></div><div class="nav-item"><a href="/courses/vc/snv/" class="nav-link router-link-exact-active router-link-active">SNV Calling</a></div><div class="nav-item"><a href="/courses/vc/sv/" class="nav-link">SV Calling</a></div><div class="nav-item"><a href="/courses/vc/appendix/" class="nav-link">Appendix</a></div> <a href="https://github.com/tobiasrausch/variant-calling" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/courses/vc/snv/" class="active sidebar-link">SNV Calling</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/courses/vc/snv/#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/courses/vc/snv/#reference-indices" class="sidebar-link">Reference Indices</a></li><li class="sidebar-sub-header"><a href="/courses/vc/snv/#alignment" class="sidebar-link">Alignment</a></li><li class="sidebar-sub-header"><a href="/courses/vc/snv/#mark-duplicates-and-alignment-quality-control" class="sidebar-link">Mark Duplicates and Alignment Quality Control</a></li><li class="sidebar-sub-header"><a href="/courses/vc/snv/#variant-calling" class="sidebar-link">Variant Calling</a></li><li class="sidebar-sub-header"><a href="/courses/vc/snv/#filtering-variants" class="sidebar-link">Filtering Variants</a></li><li class="sidebar-sub-header"><a href="/courses/vc/snv/#variant-annotation" class="sidebar-link">Variant Annotation</a></li><li class="sidebar-sub-header"><a href="/courses/vc/snv/#variant-validation" class="sidebar-link">Variant Validation</a></li></ul></li><li><a href="/courses/vc/sv/" class="sidebar-link">SV Calling</a></li><li><a href="/courses/vc/appendix/" class="sidebar-link">Appendix</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="snv-calling"><a href="#snv-calling" aria-hidden="true" class="header-anchor">#</a> SNV Calling</h1> <h2 id="introduction"><a href="#introduction" aria-hidden="true" class="header-anchor">#</a> Introduction</h2> <h3 id="disovering-a-causative-mutation-in-a-rare-disease-patient"><a href="#disovering-a-causative-mutation-in-a-rare-disease-patient" aria-hidden="true" class="header-anchor">#</a> Disovering a Causative Mutation in a Rare Disease Patient</h3> <p>This practical provides an introduction into variant discovery and genotyping. We will cover single-nucleotide variants, short insertions and deletions (InDels) and large structural variants. All data of this practical has been anonomyzed and subsampled to speed up the analyses. We will start with a <a href="https://www.ncbi.nlm.nih.gov/pubmed/23999272" target="_blank" rel="noopener noreferrer">rare disease<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> case that we analyzed in 2012. This infant of consanguineous parents suffered from severe combined immunodeficiency and the details are described in this <a href="https://www.ncbi.nlm.nih.gov/pubmed/23561803" target="_blank" rel="noopener noreferrer">publication<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="reference-indices"><a href="#reference-indices" aria-hidden="true" class="header-anchor">#</a> Reference Indices</h2> <p>We will first map the data to the Human reference genome using <a href="https://github.com/lh3/bwa" target="_blank" rel="noopener noreferrer">BWA<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. To speed up the mapping the reference genome needs to be indexed. BWA uses an FM-Index which is built around the <a href="https://de.wikipedia.org/wiki/Burrows-Wheeler-Transformation" target="_blank" rel="noopener noreferrer">Burrows-Wheeler transform<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> /data/rd/
bwa index chr7.fa
<span class="token function">ls</span> -rt1 chr7.fa*
</code></pre></div><p>It is also useful to build an index of the FASTA reference file using <a href="http://www.htslib.org" target="_blank" rel="noopener noreferrer">SAMtools<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to allow a quick extraction of subsequences from the reference genome.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>samtools faidx chr7.fa
</code></pre></div><p>We can now, for instance, extract 50bp from position 10017.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>samtools faidx chr7.fa chr7:10017-10067
</code></pre></div><p><a href="http://bedtools.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">bedtools<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> can be used to create a simple BED file with the start and end of each chromosome. We could also use the command makewindows to tile each chromosome into 10kbp windows.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bedtools makewindows -g <span class="token operator">&lt;</span><span class="token punctuation">(</span>cut -f 1,2 chr7.fa.fai<span class="token punctuation">)</span> -n 1 <span class="token operator">&gt;</span> chr7.bed
bedtools nuc -fi chr7.fa -bed chr7.bed
</code></pre></div><p><em><strong>Exercises</strong></em></p> <ul><li>What is the length of chr7?</li> <li>What is the GC-content of chr7?</li> <li>What is the proportion of Ns in chr7?</li></ul> <h2 id="alignment"><a href="#alignment" aria-hidden="true" class="header-anchor">#</a> Alignment</h2> <p>Once the index has been built we can map the paired-end <a href="https://en.wikipedia.org/wiki/FASTQ_format" target="_blank" rel="noopener noreferrer">FASTQ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> data against the reference and convert it to <a href="http://www.htslib.org" target="_blank" rel="noopener noreferrer">BAM<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bwa mem chr7.fa read1.fq.gz read2.fq.gz <span class="token operator">|</span> samtools view -bT chr7.fa - <span class="token operator">&gt;</span> rd.bam
</code></pre></div><p>Using <a href="http://www.htslib.org" target="_blank" rel="noopener noreferrer">samtools<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> we can have a look at the header and the first few alignment records:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>samtools view -H rd.bam
samtools view rd.bam <span class="token operator">|</span> <span class="token function">head</span>
</code></pre></div><p>Please familiarize yourself with the <a href="http://www.htslib.org" target="_blank" rel="noopener noreferrer">BAM<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> format, the required fields present in every bam alignment record are explained below:</p> <table><thead><tr><th>Col</th> <th>Field</th> <th>Description</th></tr></thead> <tbody><tr><td>1</td> <td>QNAME</td> <td>Query template NAME</td></tr> <tr><td>2</td> <td>FLAG</td> <td>bitwise FLAG</td></tr> <tr><td>3</td> <td>RNAME</td> <td>Reference sequence NAME</td></tr> <tr><td>4</td> <td>POS</td> <td>1-based leftmost mapping POSition</td></tr> <tr><td>5</td> <td>MAPQ</td> <td>MAPping Quality</td></tr> <tr><td>6</td> <td>CIGAR</td> <td>CIGAR string</td></tr> <tr><td>7</td> <td>RNEXT</td> <td>Ref. name of the mate/next read</td></tr> <tr><td>8</td> <td>PNEXT</td> <td>Position of the mate/next read</td></tr> <tr><td>9</td> <td>TLEN</td> <td>observed Template LENgth</td></tr> <tr><td>10</td> <td>SEQ</td> <td>segment SEQuence</td></tr> <tr><td>11</td> <td>QUAL</td> <td>ASCII of Phred-scaled base QUALity+33</td></tr></tbody></table> <p>The bitwise FLAG can be decoded using the <a href="https://broadinstitute.github.io/picard/explain-flags.html" target="_blank" rel="noopener noreferrer">explain flag tool<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> from the picard distribution.</p> <p>We need to sort the alignments and can then also built an index to allow a random extraction of alignments.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>samtools <span class="token function">sort</span> -o rd.srt.bam rd.bam
samtools index rd.srt.bam
</code></pre></div><h2 id="mark-duplicates-and-alignment-quality-control"><a href="#mark-duplicates-and-alignment-quality-control" aria-hidden="true" class="header-anchor">#</a> Mark Duplicates and Alignment Quality Control</h2> <p>Unless you are using a PCR-free library, PCR duplicates are common in DNA-sequencing and should be flagged prior to variant calling.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bammarkduplicates I<span class="token operator">=</span>rd.srt.bam O<span class="token operator">=</span>rd.rmdup.bam M<span class="token operator">=</span>rd.metrics.tsv index<span class="token operator">=</span>1 rmdup<span class="token operator">=</span>0
</code></pre></div><p>SAMtools flagstat computes some basic alignment statistics such as the number of properly paired reads and singletons.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>samtools flagstat rd.rmdup.bam
</code></pre></div><p><a href="https://github.com/tobiasrausch/alfred" target="_blank" rel="noopener noreferrer">Alfred<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> can be used to compute the insert size distribution, the coverage distribution and alignment error rates.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>alfred qc -r chr7.fa rd.rmdup.bam
</code></pre></div><p>The output file has multiple sections. Most are data matrices for quality control plots but there is also one section with summary alignment metrics.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>zcat qc.tsv.gz <span class="token operator">|</span> <span class="token function">grep</span> ^ME <span class="token operator">|</span> datamash transpose <span class="token operator">|</span> column -t
</code></pre></div><p>To create the QC plots we run the Rscript that is part of <a href="https://github.com/tobiasrausch/alfred" target="_blank" rel="noopener noreferrer">Alfred<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Rscript /opt/alfred/R/stats.R qc.tsv.gz
</code></pre></div><p>The output PDF file can then be converted to PNGs.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>convert qc.tsv.gz.pdf qc.png
<span class="token comment"># Base content distribution</span>
<span class="token function">open</span> qc-0.png
<span class="token comment"># Base quality distribution</span>
<span class="token function">open</span> qc-1.png
<span class="token comment"># Coverage</span>
<span class="token function">open</span> qc-4.png
<span class="token comment"># Insert size</span>
<span class="token function">open</span> qc-5.png
</code></pre></div><p>For calling exonic variants we are primarily interested in the coverage distribution across exons. One could, for instance, use <a href="https://www.r-project.org/" target="_blank" rel="noopener noreferrer">R Statistics<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to download exon coordinates for hg19 or download coding regions from UCSC or Ensembl. The file exons.bed.gz contains CCDS coding regions for hg19. We have to subset this bed file to the subsequence of chr7 that we are using in this practical.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>zcat exons.bed.gz <span class="token operator">|</span> <span class="token function">head</span>
bedtools intersect -a <span class="token operator">&lt;</span><span class="token punctuation">(</span>zcat exons.bed.gz<span class="token punctuation">)</span> -b chr7.bed <span class="token operator">|</span> <span class="token function">gzip</span> -c <span class="token operator">&gt;</span> exons.chr7.bed.gz
zcat exons.chr7.bed.gz <span class="token operator">|</span> <span class="token function">head</span>
</code></pre></div><p>With the exonic coordinates, <a href="https://github.com/tobiasrausch/alfred" target="_blank" rel="noopener noreferrer">Alfred<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> can be used to compute the avg. coverage per target region. In our case the targets are CCDS exons but the same method can be used to compute on-target rates for exome capture data sets.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>alfred qc -r chr7.fa -b exons.chr7.bed.gz rd.rmdup.bam
Rscript /opt/alfred/R/stats.R qc.tsv.gz
convert qc.tsv.gz.pdf qc.png
<span class="token comment"># Exon coverage distribution</span>
<span class="token function">open</span> qc-10.png
</code></pre></div><p><em><strong>Exercises</strong></em></p> <ul><li>What is the median coverage of the data set?</li> <li>What is the meaning of the different library layouts (F+, F-, R+, R-)?</li> <li>What is the duplicate fraction in the library?</li> <li>Would it make sense to sequence this library deeper to achieve 30x coverage?</li></ul> <h2 id="variant-calling"><a href="#variant-calling" aria-hidden="true" class="header-anchor">#</a> Variant Calling</h2> <p>Once the alignment is sorted and duplicates are marked we can run a variant caller such as <a href="https://github.com/ekg/freebayes" target="_blank" rel="noopener noreferrer">FreeBayes<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to scan the alignments for differences compared to the reference.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>freebayes --fasta-reference chr7.fa -b rd.rmdup.bam -v snv.vcf
</code></pre></div><p>Compressing and indexing of the output VCF file will again speed up random access to the file.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bgzip snv.vcf
tabix snv.vcf.gz
</code></pre></div><p>The <a href="https://samtools.github.io/hts-specs" target="_blank" rel="noopener noreferrer">VCF<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> format has multiple header lines starting with the hash # sign. Below the header lines is one record for each variant. The record format is described in the below table:</p> <table><thead><tr><th>Col</th> <th>Field</th> <th>Description</th></tr></thead> <tbody><tr><td>1</td> <td>CHROM</td> <td>Chromosome name</td></tr> <tr><td>2</td> <td>POS</td> <td>1-based position. For an indel, this is the position preceding the indel.</td></tr> <tr><td>3</td> <td>ID</td> <td>Variant identifier. Usually the dbSNP rsID.</td></tr> <tr><td>4</td> <td>REF</td> <td>Reference sequence at POS involved in the variant. For a SNP, it is a single base.</td></tr> <tr><td>5</td> <td>ALT</td> <td>Comma delimited list of alternative sequence(s).</td></tr> <tr><td>6</td> <td>QUAL</td> <td>Phred-scaled probability of all samples being homozygous reference.</td></tr> <tr><td>7</td> <td>FILTER</td> <td>Semicolon delimited list of filters that the variant fails to pass.</td></tr> <tr><td>8</td> <td>INFO</td> <td>Semicolon delimited list of variant information.</td></tr> <tr><td>9</td> <td>FORMAT</td> <td>Colon delimited list of the format of individual genotypes in the following fields.</td></tr> <tr><td>10+</td> <td>Samples</td> <td>Individual genotype information defined by FORMAT.</td></tr></tbody></table> <p>You can look at the header of the VCF file using grep, '-A 1' includes the first variant record in the file:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bcftools view snv.vcf.gz <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;^#&quot;</span> -A 1
</code></pre></div><p>Using <a href="https://samtools.github.io/bcftools/bcftools.html" target="_blank" rel="noopener noreferrer">BCFtools<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> we can generate some useful summary statistics such as the <a href="https://en.wikipedia.org/wiki/Transversion" target="_blank" rel="noopener noreferrer">transition/transversion ratio<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bcftools stats snv.vcf.gz <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;TSTV&quot;</span>
</code></pre></div><p><em><strong>Exercises</strong></em></p> <ul><li>How many SNPs have been called (hint: bcftools stats, SN tag)?</li> <li>How many InDels have been called (hint: bcftools stats, SN tag)?</li> <li>How many C&gt;T mutations have been called (hint: bcftools stats, ST tag)?</li></ul> <h2 id="filtering-variants"><a href="#filtering-variants" aria-hidden="true" class="header-anchor">#</a> Filtering Variants</h2> <p>In most applications researchers use external ground truth data to calibrate a variant calling pipeline. In our case we do not know the ground truth so we will illustrate some filtering options based on summary statistics such as the transition/transversion ratio. In most species, transitions are far more likely than transversions and for humans we would expect a transition/transversion ratio of approximately 2.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bcftools stats snv.vcf.gz <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;TSTV&quot;</span>
bcftools filter -i <span class="token string">'%QUAL&gt;20'</span> snv.vcf.gz  <span class="token operator">|</span> bcftools stats <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;TSTV&quot;</span>
bcftools filter -e <span class="token string">'%QUAL&lt;=20 || %QUAL/INFO/AO&lt;=2 || SAF&lt;=2 || SAR&lt;=2'</span> snv.vcf.gz  <span class="token operator">|</span> bcftools stats <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;TSTV&quot;</span>
</code></pre></div><p>Another useful bulk metric is the length of indels in exons because most InDel polymorphisms should be in-frame. If you perform variant calling on a large population cohort with hundreds of samples of different ancestry then <a href="https://en.wikipedia.org/wiki/Zygosity" target="_blank" rel="noopener noreferrer">heterozygosity<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is another metric that could be useful. For our single sample case study we move on with a simple threshold based filtering strategy to subset the VCF to exonic variants.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bcftools filter -O z -o exon.vcf.gz -R <span class="token operator">&lt;</span><span class="token punctuation">(</span>zcat exons.bed.gz<span class="token punctuation">)</span> -e <span class="token string">'%QUAL&lt;=20 || %QUAL/INFO/AO&lt;=2 || SAF&lt;=2 || SAR&lt;=2'</span> snv.vcf.gz
bcftools stats exon.vcf.gz <span class="token operator">|</span> <span class="token function">egrep</span> <span class="token string">&quot;^SN|TSTV&quot;</span>
</code></pre></div><p><a href="http://www.htslib.org" target="_blank" rel="noopener noreferrer">SAMtools<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> also includes a basic alignment viewer called tview that is useful to spot-check variants in the raw alignment data. For instance, to view the alignment data for the first two exonic variants:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bcftools view exon.vcf.gz <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;^#&quot;</span> -A 2
samtools tview -d t -p chr7:299825 rd.rmdup.bam chr7.fa
</code></pre></div><p><em><strong>Exercises</strong></em></p> <ul><li>Are the first two exonic variants homozygous or heterozygous?</li> <li>What is the genotype and the allelic depth for both variants that FreeBayes emits?</li> <li>Spot-check some heterozygous variants using samtools tview.</li> <li>Plot the InDel length distribution of all called InDels (hint: bcftools stats, IDD tag).</li></ul> <h2 id="variant-annotation"><a href="#variant-annotation" aria-hidden="true" class="header-anchor">#</a> Variant Annotation</h2> <p>Variant annotation and classification is a challenging process.</p> <ul><li>you can use transcript annotations from Ensembl, UCSC or RefSeq</li> <li>there is a long list of mutation damaging prediction tools such as PolyPhen, MutationTaster or Sift</li> <li>you can annotate variants with allele frequency information from variation archives such as 1000 Genomes, ExAC or gnomAD</li> <li>you can check the expression of genes in your studied tissue using GTEx</li> <li>you can prioritize mutations in genes that interact with known candidate genes of the disease</li> <li>you can categorize known mutations into benign and pathogenic using ClinVar</li></ul> <p>In the recent years a number of convenient pipelines have been developed that ease the annotation of variants with some of the above information. In this practical we will use <a href="http://www.ensembl.org/info/docs/tools/vep/index.html" target="_blank" rel="noopener noreferrer">VEP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> because it can be run directly online. We first dump all SNPs in a VEP compliant format which you can
then copy and paste into the VEP application. Make sure you use the hg19/GRCh37 version available <a href="http://grch37.ensembl.org/Homo_sapiens/Tools/VEP" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bcftools query -f <span class="token string">&quot;%CHROM\t%POS\t%ID\t%REF\t%ALT\n&quot;</span> exon.vcf.gz
</code></pre></div><p>A working variant annotation and classification pipeline can easily reduce an initial call set of several thousands of exonic variants to a handful mutation candidates. In a rare disease setting additional power can be gained by taking advantage of the suspected inheritance model (autosomal recessive, autosomal dominant, etc.).</p> <div class="language-bash extra-class"><pre class="language-bash"><code>bcftools query -f <span class="token string">&quot;%CHROM\t%POS\t%ID\t%REF\t%ALT\t[%GT]\n&quot;</span> exon.vcf.gz
</code></pre></div><p><em><strong>Exercises</strong></em></p> <ul><li>What would be a useful additional filter in our case given that the index patient has consanguineous parents?</li> <li>How could we use variation archives to further filter the list of exonic variants?</li> <li>Which annotation features could be used to rank the mutation list for a clinician?</li></ul> <h2 id="variant-validation"><a href="#variant-validation" aria-hidden="true" class="header-anchor">#</a> Variant Validation</h2> <p>Once a putative causative variant has been identified these are usually validated in the index patient using PCR and Sanger sequencing. If a specific inheritance model is suspected the parents are also tested. For the likely causative variant we will design primers using <a href="https://www.ncbi.nlm.nih.gov/pubmed/17485472" target="_blank" rel="noopener noreferrer">Primer3Plus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. These primers are locally unique and have the appropriate Tm but they are not necessarily unique in the entire genome. We can use <a href="https://gear.embl.de/silica" target="_blank" rel="noopener noreferrer">Silica<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, a tool for <a href="https://en.wikipedia.org/wiki/In_silico_PCR" target="_blank" rel="noopener noreferrer">In-silico PCR<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, to check genome-wide uniqueness. Both methods, Primer3Plus and Silica, are combined in <a href="https://gear.embl.de/verdin" target="_blank" rel="noopener noreferrer">Verdin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to automatically design primers for short variants and large structural variants. The example shows how SNVs, InDels and SVs are encoded and then you can design primers for the likely causative SNV. We do not have the time to run the actual PCR experiment and sequence the breakpoint mutation but the Sanger validation files of the original study are in the data folder.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ls</span> *.ab1
</code></pre></div><p>You can analyze these trace files using <a href="https://gear.embl.de/indigo" target="_blank" rel="noopener noreferrer">Indigo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Indigo is primarily for discovering InDels in Sanger traces but it also aligns the trace file to the reference genome so we can use it to compare the alignments and traces of the index patient to her parents. The files are patient.ab1, mother.ab1 and father.ab1. For your convenience, a screenshot of the sanger traces is provided in sanger.png.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">open</span> sanger.png
</code></pre></div><p>You can of course also spot-check this variant in the raw alignment.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>samtools tview -d t -p chr7:2954850 rd.rmdup.bam chr7.fa
</code></pre></div><p><em><strong>Exercises</strong></em></p> <ul><li>Why should we not put the primers directly next to the mutation?</li> <li>Why did we not select primers more than 1000bp away from the mutation?</li> <li>Is the gene of interest on the forward or reverse strand?</li> <li>Does the candidate gene make sense for a patient with severe immunodeficiency?</li> <li>Does the candidate gene interact with NFKB1?</li> <li>Can you spot the mutation in the traces and the alignment against the reference?</li> <li>What is the validated genotype by Sanger sequencing of the mother, father and patient for the mutation?</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/courses/vc/sv/">
          SV Calling
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/courses/vc/assets/js/app.12ae6cf7.js" defer></script><script src="/courses/vc/assets/js/2.65bda2c6.js" defer></script><script src="/courses/vc/assets/js/8.ff6ee130.js" defer></script>
  </body>
</html>
